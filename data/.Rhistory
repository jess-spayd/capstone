model02$rse <- sqrt(diag(vcovHC(model02, type="HC1")))
model02_pseudoR2 <- 1 - (model02$deviance) / (model02$null.deviance)
model02_pseudoR2 <- round(model02_pseudoR2, 3)
stargazer(model01, model02,
se=list(model01$rse, model02$rse),
add.lines = list(c("Pseudo R-Squared", model01_pseudoR2, model02_pseudoR2)),
type = "text",
title="Unmet MH Need by Insurance Type",
omit.stat=c("adj.rsq","f"))
stargazer(model01, model02,
se=list(model01$rse, model02$rse),
add.lines = list(c("Pseudo R-Squared", model01_pseudoR2, model02_pseudoR2)),
type = "text",
title="Unmet MH Need by Insurance Type including NONE",
omit.stat=c("adj.rsq","f"))
## Unmet MH Need by Insurance Type PRIVATE vs. PUBLIC
model03 <- glm(unmet_need ~ insurance_type +
age + military_service + sex + sexual_identity +
marital_status + education + race_ethnic + HEALTH +
emp_status + gov_asst + INCOME + urban_rural,
family = binomial(link = "logit"), data=data_instype_priv_pub)
model03$rse <- sqrt(diag(vcovHC(model03, type="HC1")))
model03_pseudoR2 <- 1 - (model03$deviance) / (model03$null.deviance)
model03_pseudoR2 <- round(model03_pseudoR2, 3)
model04 <- glm(unmet_need ~ insurance_type +
age + military_service + sex + sexual_identity +
marital_status + education + race_ethnic + HEALTH +
emp_status + gov_asst + INCOME + urban_rural,
family = binomial(link = "probit"), data=data_instype_priv_pub)
model04$rse <- sqrt(diag(vcovHC(model04, type="HC1")))
model04_pseudoR2 <- 1 - (model04$deviance) / (model04$null.deviance)
model04_pseudoR2 <- round(model04_pseudoR2, 3)
stargazer(model03, model04,
se=list(model03$rse, model04$rse),
add.lines = list(c("Pseudo R-Squared", model01_pseudoR2, model02_pseudoR2)),
type = "text",
title="Unmet MH Need by Insurance Type PRIVATE vs. PUBLIC",
omit.stat=c("adj.rsq","f"))
## Unmet MH Need by Insurance including NONE
model05 <- glm(unmet_need ~ insurance +
age + military_service + sex + sexual_identity +
marital_status + education + race_ethnic + HEALTH +
emp_status + gov_asst + INCOME + urban_rural,
family = binomial(link = "logit"), data=data_ins_known)
model05$rse <- sqrt(diag(vcovHC(model05, type="HC1")))
model05_pseudoR2 <- 1 - (model05$deviance) / (model05$null.deviance)
model05_pseudoR2 <- round(model05_pseudoR2, 3)
model06 <- glm(unmet_need ~ insurance +
age + military_service + sex + sexual_identity +
marital_status + education + race_ethnic + HEALTH +
emp_status + gov_asst + INCOME + urban_rural,
family = binomial(link = "probit"), data=data_ins_known)
model06$rse <- sqrt(diag(vcovHC(model06, type="HC1")))
model06_pseudoR2 <- 1 - (model06$deviance) / (model06$null.deviance)
model06_pseudoR2 <- round(model06_pseudoR2, 3)
stargazer(model05, model06,
se=list(model05$rse, model06$rse),
add.lines = list(c("Pseudo R-Squared", model05_pseudoR2, model06_pseudoR2)),
type = "text",
title="Unmet MH Need by Insurance Type PRIVATE vs. PUBLIC",
omit.stat=c("adj.rsq","f"))
setwd("~/Documents/GitHub/capstone/data")
data <- read.csv("nsduh_2021_final.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
data$unmet_need <- data$AMHTXND2
data$tx_util <- data$AMHTXYR4
data$age <- data$AGE3
data$military_service <- data$SERVICE
data$sex <- data$IRSEX
data$sexual_identity <- data$SEXIDENT
data$marital_status <- data$IRMARIT
data$education <- data$EDUHIGHCAT
data$race_ethnic <- data$NEWRACE2
data$emp_status <- data$IRWRKSTAT18
data$gov_asst <- data$GOVTPROG
data$urban_rural <- data$COUTYP4
class(data)
class(data$unmet_need)
class(data$tx_util)
class(data$insurance)
class(data$insurance_type)
class(data$age)
data$sex <- as.factor(sex)
data$unmet_need <- data$AMHTXND2
data$tx_util <- data$AMHTXYR4
data$age <- data$AGE3
data$military_service <- data$SERVICE
data$sex <- data$IRSEX
data$sexual_identity <- data$SEXIDENT
data$marital_status <- data$IRMARIT
data$education <- data$EDUHIGHCAT
data$race_ethnic <- data$NEWRACE2
data$emp_status <- data$IRWRKSTAT18
data$gov_asst <- data$GOVTPROG
data$urban_rural <- data$COUTYP4
data$sex <- as.factor(sex)
data$sex <- as.factor(data$sex)
unique(data$sex)
data$sex <- fct_relabel(data$sex,
"male" = "1", # 1=Male
"female" = "2") # 2=Female
data$sex <- fct_relabel(data$sex,
male = "1", # 1=Male
female = "2") # 2=Female
data$sex <- fct_recode(data$sex,
male = "1", # 1=Male
female = "2") # 2=Female
data$sex <- relevel(data$sex, ref = "male")
unique(data$sex)
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"1" = "1", # Hetero/straight
"2" = "2", # Lesbian/gay
"3" = "3", # Bisexual
"99" = c("85", "94", "97", "98", "99"))
data$sexual_identity <- as.numeric(as.character(data$sexual_identity))
data <- mutate(data, SEXIDENT = na_if(SEXIDENT, 99))
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"Heterosexual" = "1",
"Lesbian/Gay" = "2",
"Bisexual" = "3")
unique(data$sexual_identity)
data <- read.csv("nsduh_2021_final.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
data$sexual_identity <- data$SEXIDENT
data$marital_status <- data$IRMARIT
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"1" = "1", # Hetero/straight
"2" = "2", # Lesbian/gay
"3" = "3", # Bisexual
"99" = c("85", "94", "97", "98", "99"))
data$sexual_identity <- as.numeric(as.character(data$sexual_identity))
data <- mutate(data, sexual_identity = na_if(sexual_identity, 99))
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"Heterosexual" = "1",
"Lesbian/Gay" = "2",
"Bisexual" = "3")
unique(data$sexual_identity)
data$marital_status <- as.factor(data$marital_status)
data$marital_status <- fct_collapse(data$marital_status,
"1" = "1", # Married
"2" = "2", # Widowed
"3" = "3", # Divorced
"4" = c("4","99")) # Never married
data$marital_status <- as.numeric(as.character(data$marital_status))
data <- mutate(data, marital_status = na_if(marital_status, 99))
data <- read.csv("nsduh_2021_final.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
# Rename variables
data$unmet_need <- data$AMHTXND2
data$tx_util <- data$AMHTXYR4
data$age <- data$AGE3
data$military_service <- data$SERVICE
data$sex <- data$IRSEX
data$sexual_identity <- data$SEXIDENT
data$marital_status <- data$IRMARIT
data$education <- data$EDUHIGHCAT
data$race_ethnic <- data$NEWRACE2
data$emp_status <- data$IRWRKSTAT18
data$gov_asst <- data$GOVTPROG
data$urban_rural <- data$COUTYP4
# Categorical variables to factors + reference category
data$age <- as.factor(age)
data <- read.csv("nsduh_2021_final.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
# Rename variables
data$unmet_need <- data$AMHTXND2
data$tx_util <- data$AMHTXYR4
data$age <- data$AGE3
data$military_service <- data$SERVICE
data$sex <- data$IRSEX
data$sexual_identity <- data$SEXIDENT
data$marital_status <- data$IRMARIT
data$education <- data$EDUHIGHCAT
data$race_ethnic <- data$NEWRACE2
data$emp_status <- data$IRWRKSTAT18
data$gov_asst <- data$GOVTPROG
data$urban_rural <- data$COUTYP4
# Categorical variables to factors + reference category
#data$age <- as.factor(data$age)
data$sex <- as.factor(data$sex)
unique(data$sex)
data$sex <- fct_recode(data$sex,
male = "1", # 1=Male
female = "2") # 2=Female
data$sex <- relevel(data$sex, ref = "male")
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"1" = "1", # Hetero/straight
"2" = "2", # Lesbian/gay
"3" = "3", # Bisexual
"99" = c("85", "94", "97", "98", "99"))
data$sexual_identity <- as.numeric(as.character(data$sexual_identity))
data <- mutate(data, sexual_identity = na_if(sexual_identity, 99))
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"Heterosexual" = "1",
"Lesbian/Gay" = "2",
"Bisexual" = "3")
unique(data$sexual_identity)
data$sexual_identity <- relevel(data$sexual_identity, ref = "Heterosexual")
data$marital_status <- as.factor(data$marital_status)
data$marital_status <- fct_collapse(data$marital_status,
"Married" = "1",
"Widowed" = "2",
"Divorced" = "3",
"Never married" = c("4","99"))
unique(data$marital_status)
summary(data$marital_status)
data$marital_status <- relevel(data$marital_status, ref = "Never married")
data$education <- as.factor(data$education)
data$education <- fct_collapse(data$education,
"1" = "1",
"2" = "2",
"3" = "3",
"4" = "4",
"99" = "5")
data$education <- as.numeric(as.character(data$education))
data <- mutate(data, education = na_if(education, 99))
data$education <- as.factor(data$education)
data$education <- fct_collapse(data$education,
"No HS diploma" = "1",
"HS diploma" = "2",
"Some college/Assoc degree" = "3",
"Bach degree or higher" = "4")
unique(data$education)
data$education <- relevel(data$education, ref = "Heterosexual")
summary(data$education)
data$education <- relevel(data$education, ref = "Bach degree or higher")
data$race_ethnic <- as.factor(data$race_ethnic)
data$race_ethnic <- fct_collapse(data$race_ethnic,
"NonHispWhite" = "1",
"NonHispBlack" = "2",
"NonHispNativeAmAK" = "3",
"NonHispNativeHIPacIsl" = "4",
"NonHispAsian" = "5",
"NonHispMulti" = "6",
"Hispanic" = "7")
unique(data$race_ethnic)
summary(data$race_ethnic)
data$race_ethnic <- relevel(data$race_ethnic, ref = "NonHispWhite")
data$emp_status <- as.factor(data$emp_status)
data$emp_status <- fct_collapse(data$emp_status,
"1" = "1",
"2" = "2",
"3" = "3",
"4" = "4",
"99" = "99")
data$emp_status <- as.numeric(as.character(data$emp_status))
data <- mutate(data, emp_status = na_if(emp_status, 99))
data$emp_status <- as.factor(data$emp_status)
data$emp_status <- fct_collapse(data$emp_status,
"FullTime" = "1",
"PartTime" = "2",
"Unemployed" = "3",
"Other" = "4")
summary(data$emp_status)
data$emp_status <- relevel(data$emp_status, ref = "FullTime")
summary(data$urban_rural)
data$urban_rural <- as.factor(data$urban_rural)
summary(data$urban_rural)
data$urban_rural <- as.factor(data$urban_rural)
data$urban_rural <- fct_collapse(data$urban_rural,
"LargeMetro" = "1",
"SmallMetro" = "2",
"Nonmetro" = "3")
summary(data$urban_rural)
data$urban_rural <- relevel(data$urban_rural, ref = "LargeMetro")
data <- read.csv("nsduh_2021_final.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
# Rename variables
data$unmet_need <- data$AMHTXND2
data$tx_util <- data$AMHTXYR4
data$age <- data$AGE3
data$military_service <- data$SERVICE
data$sex <- data$IRSEX
data$sexual_identity <- data$SEXIDENT
data$marital_status <- data$IRMARIT
data$education <- data$EDUHIGHCAT
data$race_ethnic <- data$NEWRACE2
data$emp_status <- data$IRWRKSTAT18
data$gov_asst <- data$GOVTPROG
data$urban_rural <- data$COUTYP4
# Categorical variables to factors + reference category
## AGE
#data$age <- as.factor(data$age)
## SEX
data$sex <- as.factor(data$sex)
unique(data$sex)
data$sex <- fct_recode(data$sex,
male = "1", # 1=Male
female = "2") # 2=Female
data$sex <- relevel(data$sex, ref = "male")
## SEXUAL IDENTITY
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"1" = "1", # Hetero/straight
"2" = "2", # Lesbian/gay
"3" = "3", # Bisexual
"99" = c("85", "94", "97", "98", "99"))
data$sexual_identity <- as.numeric(as.character(data$sexual_identity))
data <- mutate(data, sexual_identity = na_if(sexual_identity, 99))
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"Heterosexual" = "1",
"Lesbian/Gay" = "2",
"Bisexual" = "3")
unique(data$sexual_identity)
data$sexual_identity <- relevel(data$sexual_identity, ref = "Heterosexual")
## MARITAL STATUS
data$marital_status <- as.factor(data$marital_status)
data$marital_status <- fct_collapse(data$marital_status,
"Married" = "1",
"Widowed" = "2",
"Divorced" = "3",
"Never married" = c("4","99"))
unique(data$marital_status)
data$marital_status <- relevel(data$marital_status, ref = "Never married")
## EDUCATION
data$education <- as.factor(data$education)
data$education <- fct_collapse(data$education,
"1" = "1",
"2" = "2",
"3" = "3",
"4" = "4",
"99" = "5")
data$education <- as.numeric(as.character(data$education))
data <- mutate(data, education = na_if(education, 99))
data$education <- as.factor(data$education)
data$education <- fct_collapse(data$education,
"No HS diploma" = "1",
"HS diploma" = "2",
"Some college/Assoc degree" = "3",
"Bach degree or higher" = "4")
unique(data$education)
data$education <- relevel(data$education, ref = "Bach degree or higher")
## RACE/ETHNICITY
data$race_ethnic <- as.factor(data$race_ethnic)
data$race_ethnic <- fct_collapse(data$race_ethnic,
"NonHispWhite" = "1",
"NonHispBlack" = "2",
"NonHispNativeAmAK" = "3",
"NonHispNativeHIPacIsl" = "4",
"NonHispAsian" = "5",
"NonHispMulti" = "6",
"Hispanic" = "7")
unique(data$race_ethnic)
data$race_ethnic <- relevel(data$race_ethnic, ref = "NonHispWhite")
## EMPLOYMENT STATUS
data$emp_status <- as.factor(data$emp_status)
data$emp_status <- fct_collapse(data$emp_status,
"1" = "1",
"2" = "2",
"3" = "3",
"4" = "4",
"99" = "99")
data$emp_status <- as.numeric(as.character(data$emp_status))
data <- mutate(data, emp_status = na_if(emp_status, 99))
data$emp_status <- as.factor(data$emp_status)
data$emp_status <- fct_collapse(data$emp_status,
"FullTime" = "1",
"PartTime" = "2",
"Unemployed" = "3",
"Other" = "4")
summary(data$emp_status)
data$emp_status <- relevel(data$emp_status, ref = "FullTime")
## URBAN/RURAL
data$urban_rural <- as.factor(data$urban_rural)
data$urban_rural <- fct_collapse(data$urban_rural,
"LargeMetro" = "1",
"SmallMetro" = "2",
"Nonmetro" = "3")
summary(data$urban_rural)
data$urban_rural <- relevel(data$urban_rural, ref = "LargeMetro")
final_dataset <- select(data, unmet_need, tx_util, insurance, insurance_type,
age, military_service, sex, sexual_identity,
marital_status, education, race_ethnic, HEALTH,
emp_status, gov_asst, INCOME, urban_rural)
write.csv(final_dataset, "nsduh_2021_final_subset.csv", row.names = FALSE)
library(readr)
nsduh_2021_final_subset <- read_csv("nsduh_2021_final_subset.csv")
View(nsduh_2021_final_subset)
# Import data
setwd("~/Documents/GitHub/capstone/data")
data <- read.csv("nsduh_2021_final_subset.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
#unique(data$insurance_type)
data_instype_known <- subset(data, insurance_type != 'unknown')
data_instype_priv_pub <- subset(data_instype_known, insurance_type != 'none')
#unique(data$insurance)
data_ins_known <- subset(data, insurance != 'unknown')
data_ins_known <- subset(data_ins_known, insurance != 'other')
data_has_ins <- subset(data_ins_known, insurance != 'none')
# Import data
setwd("~/Documents/GitHub/capstone/data")
data <- read.csv("nsduh_2021_final_subset.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
View(data)
setwd("~/Documents/GitHub/capstone/data")
data <- read.csv("nsduh_2021_final.csv",
stringsAsFactors=TRUE)
data <- as.data.frame(data)
# Rename variables
data$unmet_need <- data$AMHTXND2
data$tx_util <- data$AMHTXYR4
data$age <- data$AGE3
data$military_service <- data$SERVICE
data$sex <- data$IRSEX
data$sexual_identity <- data$SEXIDENT
data$marital_status <- data$IRMARIT
data$education <- data$EDUHIGHCAT
data$race_ethnic <- data$NEWRACE2
data$emp_status <- data$IRWRKSTAT18
data$gov_asst <- data$GOVTPROG
data$urban_rural <- data$COUTYP4
# Categorical variables to factors + reference category
## SEX
data$sex <- as.factor(data$sex)
unique(data$sex)
data$sex <- fct_recode(data$sex,
male = "1", # 1=Male
female = "2") # 2=Female
data$sex <- relevel(data$sex, ref = "male")
## SEXUAL IDENTITY
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"1" = "1", # Hetero/straight
"2" = "2", # Lesbian/gay
"3" = "3", # Bisexual
"99" = c("85", "94", "97", "98", "99"))
data$sexual_identity <- as.numeric(as.character(data$sexual_identity))
data <- mutate(data, sexual_identity = na_if(sexual_identity, 99))
data$sexual_identity <- as.factor(data$sexual_identity)
data$sexual_identity <- fct_collapse(data$sexual_identity,
"Heterosexual" = "1",
"Lesbian/Gay" = "2",
"Bisexual" = "3")
unique(data$sexual_identity)
data$sexual_identity <- relevel(data$sexual_identity, ref = "Heterosexual")
## MARITAL STATUS
data$marital_status <- as.factor(data$marital_status)
data$marital_status <- fct_collapse(data$marital_status,
"Married" = "1",
"Widowed" = "2",
"Divorced" = "3",
"Never married" = c("4","99"))
unique(data$marital_status)
data$marital_status <- relevel(data$marital_status, ref = "Never married")
## EDUCATION
#data$education <- as.factor(data$education)
#data$education <- fct_collapse(data$education,
#                              "1" = "1",
#                             "2" = "2",
#                            "3" = "3",
#                           "4" = "4",
#                          "99" = "5")
#data$education <- as.numeric(as.character(data$education))
#data <- mutate(data, education = na_if(education, 99))
#data$education <- as.factor(data$education)
#data$education <- fct_collapse(data$education,
#                              "No HS diploma" = "1",
#                             "HS diploma" = "2",
#                            "Some college/Assoc degree" = "3",
#                           "Bach degree or higher" = "4")
#unique(data$education)
#data$education <- relevel(data$education, ref = "Bach degree or higher")
## RACE/ETHNICITY
data$race_ethnic <- as.factor(data$race_ethnic)
data$race_ethnic <- fct_collapse(data$race_ethnic,
"NonHispWhite" = "1",
"NonHispBlack" = "2",
"NonHispNativeAmAK" = "3",
"NonHispNativeHIPacIsl" = "4",
"NonHispAsian" = "5",
"NonHispMulti" = "6",
"Hispanic" = "7")
unique(data$race_ethnic)
data$race_ethnic <- relevel(data$race_ethnic, ref = "NonHispWhite")
## EMPLOYMENT STATUS
data$emp_status <- as.factor(data$emp_status)
data$emp_status <- fct_collapse(data$emp_status,
"1" = "1",
"2" = "2",
"3" = "3",
"4" = "4",
"99" = "99")
data$emp_status <- as.numeric(as.character(data$emp_status))
data <- mutate(data, emp_status = na_if(emp_status, 99))
data$emp_status <- as.factor(data$emp_status)
data$emp_status <- fct_collapse(data$emp_status,
"FullTime" = "1",
"PartTime" = "2",
"Unemployed" = "3",
"Other" = "4")
summary(data$emp_status)
data$emp_status <- relevel(data$emp_status, ref = "FullTime")
final_dataset <- select(data, unmet_need, tx_util, insurance, insurance_type,
age, military_service, sex, sexual_identity,
marital_status, education, race_ethnic, HEALTH,
emp_status, gov_asst, INCOME, urban_rural)
write.csv(final_dataset, "nsduh_2021_final_subset.csv", row.names = FALSE)
View(final_dataset)
