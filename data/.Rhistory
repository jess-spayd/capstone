theme(panel.grid.major.x = element_blank())
summary(plotdata$AMHSVTYP4)
treatment_type <- filter(barplot_data, AMHSVTYP4 != '8')
treatment_type$AMHSVTYP4 <- as.factor(treatment_type$AMHSVTYP4)
treatment_type$AMHSVTYP4 <- fct_recode(treatment_type$AMHSVTYP4,
'Inpatient only' = '1',
'Outpatient only' = '2',
'Prescription meds only' = '3',
'Inpatient & Outpatient' = '4',
'Inpatient & Medication' = '5',
'Outpatient & Medication' = '6',
'Inpatient, Outpatient, & Medication' = '7')
treatment_type$AMHSVTYP4 <- fct_infreq(treatment_type$AMHSVTYP4)
plotdata <- treatment_type %>%
group_by(insurance_type, AMHSVTYP4) %>%
dplyr::summarize(n = n()) %>%
mutate(pct = n/sum(n),
lbl = scales::percent(pct))
plotdata
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 2,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
treatment_type <- filter(barplot_data, AMHSVTYP4 != '8')
treatment_type$AMHSVTYP4 <- as.factor(treatment_type$AMHSVTYP4)
treatment_type$AMHSVTYP4 <- fct_recode(treatment_type$AMHSVTYP4,
'Inpatient only' = '1',
'Outpatient only' = '2',
'Prescription meds only' = '3',
'Inpatient & Outpatient' = '4',
'Inpatient & Medication' = '5',
'Outpatient & Medication' = '6',
'Inpatient, Outpatient, & Medication' = '7')
treatment_type$AMHSVTYP4 <- fct_relevel(treatment_type$AMHSVTYP4,
'Inpatient & Medication',
'Inpatient only',
'Inpatient & Outpatient',
'Outpatient only',
'Outpatient & Medication',
'Prescription meds only',
'Inpatient, Outpatient, & Medication')
plotdata <- treatment_type %>%
group_by(insurance_type, AMHSVTYP4) %>%
dplyr::summarize(n = n()) %>%
mutate(pct = n/sum(n),
lbl = scales::percent(pct))
plotdata
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 2,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 2,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
treatment_type <- filter(barplot_data, AMHSVTYP4 != '8')
treatment_type$AMHSVTYP4 <- as.factor(treatment_type$AMHSVTYP4)
treatment_type$AMHSVTYP4 <- fct_recode(treatment_type$AMHSVTYP4,
'Inpatient only' = '1',
'Outpatient only' = '2',
'Prescription meds only' = '3',
'Inpatient & Outpatient' = '4',
'Inpatient & Medication' = '5',
'Outpatient & Medication' = '6',
'Inpatient, Outpatient, & Medication' = '7')
treatment_type$AMHSVTYP4 <- fct_relevel(treatment_type$AMHSVTYP4,
'Inpatient & Medication',
'Prescription meds only',
'Inpatient only',
'Outpatient only',
'Inpatient & Outpatient',
'Outpatient & Medication',
'Inpatient, Outpatient, & Medication')
plotdata <- treatment_type %>%
group_by(insurance_type, AMHSVTYP4) %>%
dplyr::summarize(n = n()) %>%
mutate(pct = n/sum(n),
lbl = scales::percent(pct))
plotdata
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 2,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
treatment_type <- filter(barplot_data, AMHSVTYP4 != '8')
treatment_type$AMHSVTYP4 <- as.factor(treatment_type$AMHSVTYP4)
treatment_type$AMHSVTYP4 <- fct_recode(treatment_type$AMHSVTYP4,
'Inpatient only' = '1',
'Outpatient only' = '2',
'Prescription meds only' = '3',
'Inpatient & Outpatient' = '4',
'Inpatient & Medication' = '5',
'Outpatient & Medication' = '6',
'Inpatient, Outpatient, & Medication' = '7')
treatment_type$AMHSVTYP4 <- fct_relevel(treatment_type$AMHSVTYP4,
'Inpatient only',
'Inpatient & Medication',
'Prescription meds only',
'Outpatient & Medication',
'Outpatient only',
'Inpatient & Outpatient',
'Inpatient, Outpatient, & Medication')
plotdata <- treatment_type %>%
group_by(insurance_type, AMHSVTYP4) %>%
dplyr::summarize(n = n()) %>%
mutate(pct = n/sum(n),
lbl = scales::percent(pct))
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 2,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
treatment_type <- filter(barplot_data, AMHSVTYP4 != '8')
treatment_type$AMHSVTYP4 <- as.factor(treatment_type$AMHSVTYP4)
treatment_type$AMHSVTYP4 <- fct_recode(treatment_type$AMHSVTYP4,
'Inpatient only' = '1',
'Outpatient only' = '2',
'Prescription meds only' = '3',
'Inpatient & Outpatient' = '4',
'Inpatient & Medication' = '5',
'Outpatient & Medication' = '6',
'Inpatient, Outpatient, & Medication' = '7')
treatment_type$AMHSVTYP4 <- fct_relevel(treatment_type$AMHSVTYP4,
'Inpatient only',
'Prescription meds only',
'Inpatient & Medication',
'Outpatient & Medication',
'Inpatient, Outpatient, & Medication',
'Outpatient only',
'Inpatient & Outpatient')
plotdata <- treatment_type %>%
group_by(insurance_type, AMHSVTYP4) %>%
dplyr::summarize(n = n()) %>%
mutate(pct = n/sum(n),
lbl = scales::percent(pct))
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 2,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 3,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
plotdata
plotdata <- treatment_type %>%
group_by(insurance_type, AMHSVTYP4) %>%
dplyr::summarize(n = n()) %>%
mutate(pct = n/sum(n),
lbl = round(pct*100))
plotdata
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = lbl),
size = 3,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set2')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = paste0(lbl, '%')),
size = 3,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
ggplot(plotdata, aes(fill=AMHSVTYP4, x=insurance_type, y=pct)) +
geom_bar(position='fill', stat='identity')+
labs(title="Mental Health Treatment by Insurance Type",
x="Insurance Type",
y="Percent",
fill="Treatment Type")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_brewer(palette = 'Set3')+
# scale_fill_manual(name="Treatment Type",
#                    labels=c('Inpatient only',
#                            'Outpatient only',
#                           'Prescription meds only',
#                          'Inpatient & Outpatient',
#                         'Inpatient & Medication',
#                        'Outpatient & Medication',
#                       'Inpatient, Outpatient, & Medication'),
#           values=c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7"))+
geom_text(aes(label = paste0(lbl, '%')),
size = 3,
position = position_stack(vjust = 0.5)) +
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
guide = guide_legend(reverse=TRUE),
values=c("#E69F00", "#56B4E9"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
guide = guide_legend(reverse=TRUE),
values=c("#56B4E9", "#E69F00"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#56B4E9", "#E69F00"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#56B4E9", "#D55E00"))+
theme(panel.grid.major.x = element_blank())
'Yes'),
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#56B4E9", "#CC79A7"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#56B4E9", "#E69F00"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='stack', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#56B4E9", "#E69F00"))+
theme(panel.grid.major.x = element_blank())
fill
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#56B4E9", "#E69F00"))+
theme(panel.grid.major.x = element_blank())
library(RColorBrewer)
brewer.pal(n=2, name="Set3")
3
brewer.pal(name="Set3")
brewer.pal(n=3, name="Set3")
brewer.pal(n=8, name="Set3")
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#80B1D3", "#FDB462"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#80B1D3", "#FDB462"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#80B1D3", "#FDB462"))+
theme(panel.grid.major.x = element_blank(),
axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
ggplot(barplot_data, aes(fill=factor(AMHTXYR4), x=insurance)) +
geom_bar(position='fill', stat='count')+
labs(title="Mental Health Treatment Utilization by Insurance",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Treatment Utilization",
labels=c('No',
'Yes'),
values=c("#676767", "#b6b6b6"))+
theme(panel.grid.major.x = element_blank(),
axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
ggplot(barplot_data, aes(fill=factor(AMHTXND2), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Unmet Mental Health Needs by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_discrete(name="Unmet need",
labels=c('No','Yes'),
guide = guide_legend(reverse=TRUE))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXND2), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Unmet Mental Health Needs by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_discrete(name="Unmet need",
labels=c('No','Yes'),
values=c("#676767", "#b6b6b6"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXND2), x=insurance_type)) +
geom_bar(position='fill', stat='count')+
labs(title="Unmet Mental Health Needs by Insurance Type",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Unmet need",
labels=c('No','Yes'),
values=c("#676767", "#b6b6b6"))+
theme(panel.grid.major.x = element_blank())
ggplot(barplot_data, aes(fill=factor(AMHTXND2), x=insurance)) +
geom_bar(position='fill', stat='count')+
labs(title="Unmet Mental Health Needs by Insurance",
x="Insurance Type",
y="Percent")+
scale_y_continuous(labels=c('0', '25', '50', '75', '100'))+
scale_fill_manual(name="Unmet need",
labels=c('No','Yes'),
values=c("#676767", "#b6b6b6"))+
theme(panel.grid.major.x = element_blank())
